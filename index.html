<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TRI·∫æT H·ªåC MARX-LENIN</title>

    <!-- Three.js & MediaPipe -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/control_utils/control_utils.js"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js" crossorigin="anonymous"></script>

    <!-- GSAP Animation Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

    <link rel="stylesheet" href="style.css">
</head>

<body>
    <!-- Background Music -->
    <audio id="bg-music" src="dang.mp3" loop preload="auto"></audio>

    <!-- Audio Toggle Button -->
    <button id="audio-btn" onclick="toggleAudio()" title="B·∫≠t/T·∫Øt nh·∫°c">üîá</button>

    <!-- Welcome Screen -->
    <div id="welcome-overlay">
        <div id="welcome-container">
            <h1 id="welcome-title">
                <span class="title-char">‚ò≠</span>
                <span class="title-char">&nbsp;</span>
                <span class="title-char">T</span>
                <span class="title-char">R</span>
                <span class="title-char">I</span>
                <span class="title-char">·∫æ</span>
                <span class="title-char">T</span>
                <span class="title-char">&nbsp;</span>
                <span class="title-char">H</span>
                <span class="title-char">·ªå</span>
                <span class="title-char">C</span>
                <span class="title-char">&nbsp;</span>
                <span class="title-char">M</span>
                <span class="title-char">A</span>
                <span class="title-char">R</span>
                <span class="title-char">X</span>
                <span class="title-char">-</span>
                <span class="title-char">L</span>
                <span class="title-char">E</span>
                <span class="title-char">N</span>
                <span class="title-char">I</span>
                <span class="title-char">N</span>
            </h1>
            <p id="welcome-subtitle">Kh√°m ph√° d√≤ng ch·∫£y l·ªãch s·ª≠</p>

            <div id="welcome-options">
                <button class="welcome-btn" onclick="startGestureMode()">
                    <span class="btn-icon">üñê</span>
                    <span class="btn-text">Tr·∫£i nghi·ªám c·ª≠ ch·ªâ tay</span>
                    <span class="btn-desc">ƒêi·ªÅu khi·ªÉn b·∫±ng camera</span>
                </button>

                <button class="welcome-btn" onclick="startMouseMode()">
                    <span class="btn-icon">üñ±Ô∏è</span>
                    <span class="btn-text">D√πng con tr·ªè</span>
                    <span class="btn-desc">ƒêi·ªÅu khi·ªÉn b·∫±ng chu·ªôt</span>
                </button>
            </div>
        </div>
    </div>

    <div id="canvas-container"></div>
    <!-- L·ªõp ph·ªß ·∫£nh n·ªÅn trang tr√≠ -->
    <div class="bg-overlay"></div>

    <!-- Header -->
    <div id="header" style="display: none;">
        <div id="title">‚ò≠ TRI·∫æT H·ªåC MARX-LENIN</div>
        <canvas id="camera-preview" style="display: none;"></canvas>
    </div>

    <!-- Carousel Cards Container -->
    <div id="node-cards-container">


        <div id="node-cards-wrapper">
            <div class="node-card" data-node-id="1">
                <div class="card-image">
                    <div
                        style="width:100%;height:100%;background:linear-gradient(135deg,#8B0000,#D32F2F);display:flex;align-items:center;justify-content:center;font-size:48px;">
                        ‚ò≠</div>
                </div>
                <div class="card-content">
                    <h3 class="card-title">Tr∆∞·ªõc 1840s ‚Äì 1890s</h3>
                    <p class="card-desc">S·ª± ra ƒë·ªùi v√† ho√†n thi·ªán c·ªßa ch·ªß nghƒ©a Marx</p>
                </div>
            </div>

            <div class="node-card" data-node-id="2">
                <div class="card-image">
                    <div
                        style="width:100%;height:100%;background:linear-gradient(135deg,#B30000,#FF6B6B);display:flex;align-items:center;justify-content:center;font-size:48px;">
                        ‚öíÔ∏è</div>
                </div>
                <div class="card-content">
                    <h3 class="card-title">1900s ‚Äì 1920s</h3>
                    <p class="card-desc">T·ª´ l√Ω lu·∫≠n Marx ƒë·∫øn th·ª±c ti·ªÖn Lenin</p>
                </div>
            </div>

            <div class="node-card" data-node-id="3">
                <div class="card-image">
                    <div
                        style="width:100%;height:100%;background:linear-gradient(135deg,#FFD700,#FFA500);display:flex;align-items:center;justify-content:center;font-size:48px;">
                        üìö</div>
                </div>
                <div class="card-content">
                    <h3 class="card-title">1920s ‚Äì 1945</h3>
                    <p class="card-desc">C·ªßng c·ªë m√¥ h√¨nh XHCN v√† ·∫£nh h∆∞·ªüng trong phong tr√†o c√°ch m·∫°ng th·∫ø gi·ªõi</p>
                </div>
            </div>

            <div class="node-card" data-node-id="4">
                <div class="card-image">
                    <div
                        style="width:100%;height:100%;background:linear-gradient(135deg,#4ECDC4,#44A08D);display:flex;align-items:center;justify-content:center;font-size:48px;">
                        üåè</div>
                </div>
                <div class="card-content">
                    <h3 class="card-title">1947 ‚Äì 1970s</h3>
                    <p class="card-desc">M·ªü r·ªông h·ªá th·ªëng XHCN trong b·ªëi c·∫£nh Chi·∫øn tranh L·∫°nh</p>
                </div>
            </div>

            <div class="node-card" data-node-id="5">
                <div class="card-image">
                    <div
                        style="width:100%;height:100%;background:linear-gradient(135deg,#667eea,#764ba2);display:flex;align-items:center;justify-content:center;font-size:48px;">
                        üîÑ</div>
                </div>
                <div class="card-content">
                    <h3 class="card-title">1980s ‚Äì 2000s</h3>
                    <p class="card-desc">Kh·ªßng ho·∫£ng v√† tan r√£ c·ªßa h·ªá th·ªëng XHCN. T√°i ƒë·ªãnh h√¨nh con ƒë∆∞·ªùng ph√°t tri·ªÉn</p>
                </div>
            </div>

            <div class="node-card" data-node-id="6">
                <div class="card-image">
                    <div
                        style="width:100%;height:100%;background:linear-gradient(135deg,#f093fb,#f5576c);display:flex;align-items:center;justify-content:center;font-size:48px;">
                        üåê</div>
                </div>
                <div class="card-content">
                    <h3 class="card-title">2000s ‚Äì Nay</h3>
                    <p class="card-desc">T√°c ƒë·ªông ƒë∆∞∆°ng ƒë·∫°i c·ªßa ch·ªß nghƒ©a Marx‚ÄìLenin trong b·ªëi c·∫£nh to√†n c·∫ßu</p>
                </div>
            </div>
        </div>

    </div>

    <!-- Vertical Gesture Panel (Right Side)    -->
    <div id="gesture-panel">
        <div id="controls-vertical">
            <div class="gesture-hint">
                <span class="gesture-icon">üëà</span>
                <span>Tr√°i: Di chuy·ªÉn</span>
            </div>
            <div class="gesture-hint">
                <span class="gesture-icon">‚òùÔ∏è</span>
                <span>P1: Cursor</span>
            </div>
            <div class="gesture-hint">
                <span class="gesture-icon">‚úåÔ∏è</span>
                <span>P2: Ch·ªçn</span>
            </div>
            <div class="gesture-hint">
                <span class="gesture-icon">ü§è</span>
                <span>Pinch: Zoom+</span>
            </div>
            <div class="gesture-hint">
                <span class="gesture-icon">‚úä</span>
                <span>ƒê·∫•m: Zoom-</span>
            </div>
            <div class="gesture-hint">
                <span class="gesture-icon">üññ</span>
                <span>3 ng√≥n: Quay</span>
            </div>
        </div>
    </div>

    <!-- Toggle Cursor Button (Old - will be hidden) -->
    <button id="btn-toggle-cursor-old" onclick="toggleCursor()" style="display: none;">üëÜ Con tr·ªè: T·∫Øt</button>
    <button id="btn-toggle-cursor-standalone" onclick="toggleCursor()" style="display: none;">üëÜ Con tr·ªè: T·∫Øt</button>

    <!-- Virtual Cursor -->
    <div id="virtual-cursor"></div>

    <!-- Start Button (Hidden - replaced by welcome screen) -->
    <button id="btnStart" onclick="startSystem()" style="display: none;">üñê START WITH GESTURES</button>

    <!-- Status -->
    <!-- Status removed -->

    <!-- Node Info Panel -->
    <div id="node-info">
        <h3 id="node-title">Node Title</h3>
        <p id="node-desc">Node description goes here</p>
    </div>

    <!-- Controls Hint (Old - Hidden) -->
    <div id="controls" style="display: none;">
        <div class="gesture-hint">
            <span class="gesture-icon">üñêÔ∏è</span>
            <span>Tr√°i: Di chuy·ªÉn</span>
        </div>
        <div class="gesture-hint">
            <span class="gesture-icon">‚òùÔ∏è</span>
            <span>1 ng√≥n: Cursor</span>
        </div>
        <div class="gesture-hint">
            <span class="gesture-icon">‚úåÔ∏è</span>
            <span>2 ng√≥n: Ch·ªçn</span>
        </div>
        <div class="gesture-hint">
            <span class="gesture-icon">ü§è</span>
            <span>Nh√≥n: Zoom+</span>
        </div>
        <div class="gesture-hint">
            <span class="gesture-icon">‚úä</span>
            <span>ƒê·∫•m: Zoom-</span>
        </div>
        <div class="gesture-hint">
            <span class="gesture-icon">üññ</span>
            <span>3 ng√≥n: Back</span>
        </div>
    </div>

    <!-- Debug -->
    <div id="debug"></div>

    <!-- Detail View Overlay (Drill-down) -->
    <div id="detail-overlay">
        <div id="detail-container">
            <!-- Title -->
            <h1 id="detail-title">Th·ª≠ th√°ch</h1>

            <!-- Quote / Description -->
            <div id="detail-quote">
                Kh√¥ng c√≥ h√†nh tr√¨nh n√†o m√† kh√¥ng c√≥ th·ª≠ th√°ch. ƒê√¢y l√† giai ƒëo·∫°n ƒë·ªëi m·∫∑t v·ªõi nh·ªØng kh√≥ khƒÉn, h·ªçc c√°ch
                th√≠ch nghi v√† t√¨m ra gi·∫£i ph√°p s√°ng t·∫°o.
            </div>

            <!-- Events Timeline -->
            <div class="detail-section" id="events-section">
                <h3 class="detail-section-title">üìÖ S·ª± ki·ªán</h3>
                <div id="detail-events">
                    <!-- Events will be dynamically inserted here -->
                </div>
            </div>

            <!-- Sub-nodes -->
            <div class="detail-section" id="subnodes-section">
                <h3 class="detail-section-title">üåø Nh√°nh con</h3>
                <div id="detail-subnodes">
                    <!-- Sub-nodes will be dynamically inserted here -->
                </div>
            </div>
        </div>

        <!-- Removed redundant detail-gesture-hint -->
    </div>


    <!-- Global Back Button (Bottom-Right) -->
    <button id="global-back-btn" onclick="goBack()" style="display: none;">
        ‚Üê Quay l·∫°i
    </button>

    <!-- Copyright -->
    <div id="copyright">¬© Marx-lenin by Group 8 + 5</div>

    <!-- Hidden Video -->
    <video class="video-hidden input_video"></video>

    <script src="data.js"></script>
    <script src="script.js"></script>

    <!-- GSAP Title Scatter Animation -->
    <script>
        // Wait for DOM to load
        document.addEventListener('DOMContentLoaded', function () {
            const chars = document.querySelectorAll('.title-char');

            // Helper function to get random value
            function getRandom(min, max) {
                return Math.random() * (max - min) + min;
            }

            // Set initial state - scattered positions
            chars.forEach((char, index) => {
                gsap.set(char, {
                    x: getRandom(-600, 600),
                    y: getRandom(-400, 400),
                    rotation: getRandom(-720, 720),
                    scale: 0,
                    opacity: 0
                });
            });

            // Create timeline for animation
            const tl = gsap.timeline({
                delay: 0.3
            });

            // Animate each character to its final position
            tl.to(chars, {
                x: 0,
                y: 0,
                rotation: 0,
                scale: 1,
                opacity: 1,
                duration: 1.2,
                ease: "power4.out",
                stagger: {
                    each: 0.05,
                    from: "center"
                }
            });

            // Add glow pulse after assembly
            tl.to(chars, {
                textShadow: "0 0 30px rgba(255, 204, 0, 1), 0 0 60px rgba(255, 204, 0, 0.8)",
                duration: 0.3,
                stagger: 0.02
            });

            tl.to(chars, {
                textShadow: "0 0 20px rgba(255, 204, 0, 0.5)",
                duration: 0.5
            });
        });
    </script>
</body>

</html>